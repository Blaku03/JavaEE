<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                template="/WEB-INF/template.xhtml">

    <f:metadata>
        <f:viewParam name="id" value="#{workoutSessionController.sessionId}" required="true"/>
        <f:viewParam name="typeId" value="#{workoutSessionController.typeId}"/>

        <f:viewAction action="#{workoutSessionController.loadSessionForEdit}" onPostback="false" />
    </f:metadata>

    <ui:define name="title">
        #{workoutSessionController.sessionId == 'new' ? 'Dodaj' : 'Edytuj'} Sesję Treningową
    </ui:define>

    <ui:define name="content">
        <h2>#{workoutSessionController.sessionId == 'new' ? 'Dodaj' : 'Edytuj'} Sesję Treningową</h2>

        <h:form>
            <h:messages globalOnly="false" style="color: red; list-style-type: none; padding: 0; margin-bottom: 1rem;"/>

            <div class="form-group">
                <h:outputLabel value="Kategoria (Typ Treningu)" for="category"/>
                <h:selectOneMenu id="category"
                                 value="#{workoutSessionController.session.workoutType}"
                                 converter="workoutTypeConverter"
                                 required="true"
                                 requiredMessage="Kategoria jest wymagana.">
                    <f:selectItem itemLabel="-- Wybierz kategorię --" itemValue="#{null}" noSelectionOption="true"/>
                    <f:selectItems value="#{workoutSessionController.allTypes}"
                                   var="type"
                                   itemLabel="#{type.name}"
                                   itemValue="#{type}"/>
                </h:selectOneMenu>
            </div>

            <div class="form-group">
                <h:outputLabel value="Status" for="status"/>
                <h:selectOneMenu id="status"
                                 value="#{workoutSessionController.session.status}"
                                 required="true"
                                 requiredMessage="Status jest wymagany.">
                    <f:selectItems value="#{workoutSessionController.getWorkoutStatuses()}"
                                   var="status"
                                   itemLabel="#{status}"
                                   itemValue="#{status}"/>
                </h:selectOneMenu>
            </div>

            <div class="form-group">
                <h:outputLabel value="Czas Rozpoczęcia" for="startTime"/>
                <h:inputText id="startTime"
                             value="#{workoutSessionController.session.startTime}"
                             pt:type="datetime-local"
                             required="true"
                             requiredMessage="Czas rozpoczęcia jest wymagany.">
                    <f:convertDateTime type="localDateTime" pattern="yyyy-MM-dd'T'HH:mm" />
                </h:inputText>
            </div>

            <div class="form-group">
                <h:outputLabel value="Czas Zakończenia (opcjonalnie)" for="endTime"/>
                <h:inputText id="endTime"
                             value="#{workoutSessionController.session.endTime}"
                             pt:type="datetime-local">
                    <f:convertDateTime type="localDateTime" pattern="yyyy-MM-dd'T'HH:mm" />
                </h:inputText>
            </div>

            <h:commandButton value="Zapisz"
                             action="#{workoutSessionController.saveSession()}"
                             styleClass="btn"/>

            <h:link value="Anuluj"
                    outcome="category_view.xhtml"
                    styleClass="btn btn-danger"
                    rendered="#{workoutSessionController.session.workoutType != null}">
                <f:param name="id" value="#{workoutSessionController.session.workoutType.id}"/>
            </h:link>

            <h:link value="Anuluj"
                    outcome="categories.xhtml"
                    styleClass="btn btn-danger"
                    rendered="#{workoutSessionController.session.workoutType == null}"/>
        </h:form>
    </ui:define>

</ui:composition>